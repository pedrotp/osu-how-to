<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Getting Started with the Dropbox API</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-social/5.1.1/bootstrap-social.min.css" />
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">
              Dropbox API: Getting Started
            </a>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Step 4: Downloading<span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="index.html">Welcome</a></li>
                  <li><a href="1.html">Step 1: HTTP Review</a></li>
                  <li><a href="2.html">Step 2: OAuth</a></li>
                  <li><a href="3.html">Step 3: Uploading</a></li>
                  <li><a href="#">Step 4: Downloading</a></li>
                </ul>
              </li>
            </ul>
          </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
      </nav>
      <br>
      <h1 class="text-center">Downloading Files</h1><br>
      <p class="lead text-center">Finally, we are going to learn how to access the files you've already saved in your Dropbox APP folder. Now that we've successfully authenticated and uploaded files to our Dropbox, this shouldn't be too hard.</p>
      <p class="ptp-body-text">The one complication we are introducing in this step, is that we are going to have to do <strong>nested HTTP requests</strong> to properly display all the items in your Dropbox. To get all the animated GIFs you saved in your app folder in the previous section, we first have to make a request to the <code>/list_folder</code> endpoint to get an array with information about all the files in your app folder. Then, we loop through all the items in that array to make individual requests to the <code>/download</code> endpoint, to request each file individually and add it to the DOM with a little jQuery magic.</p>
      <!-- <blockquote>
        <code>request.open('POST', 'https://api.dropboxapi.com/2/files/save_url', true);</code>
      </blockquote>
      <p class="ptp-body-text">Here, we open our asynchronous POST request to the save_url endpoint in the Dropbox API.</p>
      <blockquote>
        <code>request.setRequestHeader('Authorization', 'Bearer ' + QueryObj.access_token);</code>
      </blockquote>
      <p class="ptp-body-text">This line sets the Authorization request header to the bearer token we received during authentication in the previous page of the tutorial. This header tells the Dropbox API who we are.</p>
      <blockquote>
        <code>var data = { path: '/' + fileName, url: $(this).attr('src') };</code>
      </blockquote>
      <p class="ptp-body-text">This is the data that is sent to Dropbox as JSON. It includes two parameters, the <strong>path</strong> where we are going to store the file in our app folder, and the <strong>url</strong> from which we are fetching the file. In this case, the URL is the <em>src</em> attribute of the image we just clicked on.</p> -->
      <br>
      <p class="ptp-body-text">Explore the code in the fiddle below, and then hit the <strong>Log in with Dropbox</strong> button below to log in and try this last landing page in action. All the GIFs you have previously saved should show up.</p>
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <script async src="https://jsfiddle.net/pedrotp/L2bw8z3n/1/embed/js,html/"></script>
        </div>
      </div>
      <div class="container-fluid">
        <h1 class="text-center">Log in here:</h1>
        <a class="btn btn-large btn-social btn-dropbox col-xs-6 col-xs-offset-3 col-md-4 col-md-offset-4" target="_blank" href="https://www.dropbox.com/1/oauth2/authorize/?response_type=token&client_id=30s66ycuybxn0ai&redirect_uri=https://pedrotp.github.io/osu-how-to/download.html">
        <span class="fa fa-dropbox"></span>Log in with Dropbox</a>
      </div>
      <br><br>
      <p class="lead text-center">That's it! You now know how to authenticate, download files and upload files from the Dropbox API. From there, it's easy to continue to explore the API documentation to build even more complex apps. Good luck!</p>
      <nav>
        <ul class="pager">
          <li class="previous"><a href="3.html"><span aria-hidden="true">&larr;</span> Previous</a></li>
          <!-- <li class="next"><a href="4.html">Next <span aria-hidden="true">&rarr;</span></a></li> -->
        </ul>
      </nav>
    </div>
  </body>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</html>
